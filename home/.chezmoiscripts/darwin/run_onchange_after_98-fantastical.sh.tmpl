#!/usr/bin/env bash

# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   @author         :   Chris Burnham
#   @file           :
#   @description    :
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# --------------------------------------------------------------------------------------------------
#   @description    :   Get script libraries
# --------------------------------------------------------------------------------------------------
{{ template "script-library" }}
# ==================================================================================================

# --------------------------------------------------------------------------------------------------
#   @description    :   Pre-flight
# --------------------------------------------------------------------------------------------------
info "[ðŸ“…     Fantastical] Setting log level to debug."
LOG_LEVEL=7

debug "[ðŸ“…     Fantastical] Verifying installation."

if ! check_macos_app "Fantastical.app"; then
  info "[ðŸ“…     Fantastical] Application is not installed."
  exit 0

else
  debug "[ðŸ“…     Fantastical] Application is installed."
  info "[ðŸ“…     Fantastical] Closing Fantastical, to prevent it from overriding changes."
  osascript -e 'tell application "Fantastical" to quit'
  killall "cfprefsd"

fi
# ==================================================================================================

# --------------------------------------------------------------------------------------------------
#   @description    :   Fantastical | Settings | Advanced
# --------------------------------------------------------------------------------------------------
### Automatically check for updates
debug "[ðŸ“…     Fantastical] Settings | Advanced | Automatically check for updates"
#   option [default] --> checked
defaults write com.flexibits.fantastical2.mac SUEnableAutomaticChecks -bool true
#   option --> unchecked
# defaults write com.flexibits.fantastical2.mac SUEnableAutomaticChecks -bool false

### Include anonymous system profile
debug "[ðŸ“…     Fantastical] Settings | Advanced | Include anonymous system profile"
#   option [default] --> checked
# defaults write com.flexibits.fantastical2.mac SUSendProfileInfo -bool true
#   option --> unchecked
defaults write com.flexibits.fantastical2.mac SUSendProfileInfo -bool false
# ==================================================================================================

info "[ðŸ“…     Fantastical] Configuration complete."
